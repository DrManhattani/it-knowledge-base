---
tags:
  - üåê/cisco
  - üåê/cisco/cmd
üí†Stack: üüß Cisco
üìü Device:
  - ‚åò Sw
üì∂ Mode:
  - ‚öôÔ∏è Config-If
üóÇÔ∏è Category:
  - üîå Interfaces
  - üõ°Ô∏è Sec
üìù Description: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã –ø–æ—Ä—Ç–∞ (Access/Trunk) –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è DTP.
‚ö° Alias: sw mode
üíª Command: switchport mode
---
# üìñ –ì–ª–∞–≤–∞: –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã –ø–æ—Ä—Ç–∞ (Mode & DTP)

–ö–æ–º–∞–Ω–¥–∞ `switchport mode` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –ø–æ—Ä—Ç –±—É–¥–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å —Å–æ—Å–µ–¥–æ–º.
–ë—É–¥–µ—Ç –ª–∏ –æ–Ω –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ VLAN (–¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞) –∏–ª–∏ –≤—Å–µ—Ö VLAN —Å—Ä–∞–∑—É (–¥–ª—è –¥—Ä—É–≥–æ–≥–æ —Å–≤–∏—Ç—á–∞).

---

> [!INFO]+ üèóÔ∏è 1. –ß–µ—Ç—ã—Ä–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
> Cisco –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å —Ä–µ–∂–∏–º –∂–µ—Å—Ç–∫–æ (Static) –∏–ª–∏ –¥–æ–≤–µ—Ä–∏—Ç—å –≤—ã–±–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏–∫–µ (Dynamic).
> 
> | –†–µ–∂–∏–º | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –î–ª—è –∫–æ–≥–æ? |
> | :--- | :--- | :--- | :--- |
> | **access** | **Static** | –ü–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ** –≤ –æ–¥–Ω–æ–º VLAN. –ò—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –±–µ–∑ —Ç–µ–≥–æ–≤. DTP –æ—Ç–∫–ª—é—á–µ–Ω. | –ö–æ–º–ø—å—é—Ç–µ—Ä—ã, –ü—Ä–∏–Ω—Ç–µ—Ä—ã, –†–æ—É—Ç–µ—Ä—ã (–±–µ–∑ sub-int). |
> | **trunk** | **Static** | –ü–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ **–≤—Å–µ–º–∏** —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º–∏ VLAN. –¢—Ä–∞—Ñ–∏–∫ —Ç–µ–≥–∏—Ä—É–µ—Ç—Å—è (802.1Q). | –°–≤–∏—Ç—á–∏, –†–æ—É—Ç–µ—Ä—ã (ROAS), –¢–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞, –°–µ—Ä–≤–µ—Ä—ã ESXi. |
> | **dynamic auto** | *Dynamic* | **–ü–∞—Å—Å–∏–≤–Ω—ã–π.** "–Ø —Å—Ç–∞–Ω—É —Ç—Ä–∞–Ω–∫–æ–º, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–æ—Å–µ–¥ –º–µ–Ω—è –æ—á–µ–Ω—å –ø–æ–ø—Ä–æ—Å–∏—Ç". –ï—Å–ª–∏ —Å–æ—Å–µ–¥ –º–æ–ª—á–∏—Ç ‚Äî —è –±—É–¥—É Access. | –î–µ—Ñ–æ–ª—Ç –Ω–∞ —Å—Ç–∞—Ä—ã—Ö —Å–≤–∏—Ç—á–∞—Ö. |
> | **dynamic desirable** | *Dynamic* | **–ê–∫—Ç–∏–≤–Ω—ã–π.** "–Ø —Ö–æ—á—É –±—ã—Ç—å —Ç—Ä–∞–Ω–∫–æ–º! –≠–π, —Å–æ—Å–µ–¥, –¥–∞–≤–∞–π –ø–æ–¥–Ω–∏–º–µ–º —Ç—Ä–∞–Ω–∫?". | –î–µ—Ñ–æ–ª—Ç –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–æ—â–Ω—ã—Ö —Å–≤–∏—Ç—á–∞—Ö (Catalyst 3650+). |

> [!danger]+ ‚öîÔ∏è 2. –û–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏–∫–∏ (DTP)
> –ü—Ä–æ—Ç–æ–∫–æ–ª DTP (Dynamic Trunking Protocol), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–∞—Ö `dynamic`, —Å—á–∏—Ç–∞–µ—Ç—Å—è **—É—è–∑–≤–∏–º–æ—Å—Ç—å—é**.
> 
> **–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏ (VLAN Hopping):**
> 1. –•–∞–∫–µ—Ä –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ø–æ—Ä—Ç—É, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–æ–∏—Ç –≤ `dynamic auto` (–¥–µ—Ñ–æ–ª—Ç).
> 2. –•–∞–∫–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–æ—Ñ—Ç (Yersinia), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Ç–≤–æ—Ä—è–µ—Ç—Å—è —Å–≤–∏—Ç—á–µ–º –∏ —à–ª–µ—Ç DTP-–∑–∞–ø—Ä–æ—Å ("–Ø desirable!").
> 3. –ü–æ—Ä—Ç —Å–≤–∏—Ç—á–∞ —Ä–∞–¥–æ—Å—Ç–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º **Trunk**.
> 4. **–ò—Ç–æ–≥:** –•–∞–∫–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º—É —Ç—Ä–∞—Ñ–∏–∫—É –≤—Å–µ—Ö VLAN –≤ –≤–∞—à–µ–π —Å–µ—Ç–∏.
> 
> **Best Practice:**
> –í—Å–µ–≥–¥–∞ –æ—Ç–∫–ª—é—á–∞–π—Ç–µ DTP –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–æ—Ä—Ç–∞—Ö –∫–æ–º–∞–Ω–¥–æ–π `switchport mode access`.
> –ù–∞ –º–∞–≥–∏—Å—Ç—Ä–∞–ª—å–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö –æ—Ç–∫–ª—é—á–∞–π—Ç–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π `switchport nonegotiate`.

> [!NOTE]+ üß© 3. –ú–∞—Ç—Ä–∏—Ü–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (–ö—Ç–æ –∫–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç?)
> –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ —Å–æ–µ–¥–∏–Ω–∏—Ç—å –¥–≤–∞ –ø–æ—Ä—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏?
> 
> | –í–∞—à –ø–æ—Ä—Ç | –ü–æ—Ä—Ç —Å–æ—Å–µ–¥–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
> | :--- | :--- | :--- |
> | **Auto** | **Auto** | **Access** (–û–±–∞ –∂–¥—É—Ç, –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç). |
> | **Auto** | **Desirable** | **Trunk** (–û–¥–∏–Ω –ø—Ä–µ–¥–ª–æ–∂–∏–ª, –≤—Ç–æ—Ä–æ–π —Å–æ–≥–ª–∞—Å–∏–ª—Å—è). |
> | **Desirable** | **Desirable** | **Trunk** (–û–±–∞ —Ö–æ—Ç—è—Ç). |
> | **Access** | **Trunk** | ‚ö†Ô∏è **–û—à–∏–±–∫–∞ / Mismatch.** –°–≤—è–∑–∏ –Ω–µ –±—É–¥–µ—Ç –∏–ª–∏ –±—É–¥–µ—Ç —á–∞—Å—Ç–∏—á–Ω–∞—è –ø–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤. |

> [!example]+ üöÄ 4. –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (Best Practices)
> 
> **–°—Ü–µ–Ω–∞—Ä–∏–π –ê: –ü–æ—Ä—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞)**
> ```bash
> interface Gi0/1
>  description User_PC
>  switchport mode access
>  switchport access vlan 10
>  ! (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏—Ç—å DTP –ø–∞–∫–µ—Ç—ã
>  switchport nonegotiate
> ```
> 
> **–°—Ü–µ–Ω–∞—Ä–∏–π –ë: –ü–æ—Ä—Ç –∫ –¥—Ä—É–≥–æ–º—É —Å–≤–∏—Ç—á—É (–ú–∞–≥–∏—Å—Ç—Ä–∞–ª—å)**
> ```bash
> interface Gi0/24
>  description Uplink_to_Core
>  switchport mode trunk
>  ! –ó–∞–ø—Ä–µ—â–∞–µ–º –ø–æ—Ä—Ç—É –ø—ã—Ç–∞—Ç—å—Å—è –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è (–º—ã –∏ —Ç–∞–∫ –∑–∞–¥–∞–ª–∏ –∂–µ—Å—Ç–∫–æ)
>  switchport nonegotiate
> ```

---

## üîó –°–≤—è–∑–∏
* **–î–µ—Ç–∞–ª–∏ Access:** [[Cs - switchport access vlan | switchport access vlan]].
* **–î–µ—Ç–∞–ª–∏ Trunk:** [[Cs - switchport trunk allowed vlan]] (–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è VLAN –≤ —Ç—Ä–∞–Ω–∫–µ).
* **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –¢–µ–º–∞ [[Cs - port-security]].