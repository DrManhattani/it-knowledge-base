---
tags:
  - üåê/cisco
  - üåê/cisco/cmd
üí†Stack: üüß Cisco
üìü Device:
  - ‚óà Rtr
  - ‚åò Sw
üì∂ Mode:
  - ‚öôÔ∏è Config
üóÇÔ∏è Category:
  - üõ°Ô∏è Sec
  - üïπÔ∏è Mgmt
üìù Description: "–ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-—Å–µ—Ä–≤–µ—Ä–∞: –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞, –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏."
‚ö° Alias: ip ssh
üíª Command: ip ssh
---
# üí° –û–ø–∏—Å–∞–Ω–∏–µ
> [!SUMMARY] –°—É—Ç—å
> –ö–æ–º–∞–Ω–¥–∞ `ip ssh` —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –¥–µ–º–æ–Ω–∞ SSH (SSH Daemon) –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.
> –≠—Ç–æ "–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é" —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
> * –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫–ª—é—á–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã.
> * –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –∞—Ç–∞–∫–∏ –ø–µ—Ä–µ–±–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π.
> * –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (AES, 3DES, SHA) —Ä–æ—É—Ç–µ—Ä —Å–æ–≥–ª–∞—Å–∏—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–∏.

---

> [!danger]+ üèóÔ∏è 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏ (Version Control)
> –≠—Ç–æ –ø–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è –æ–±–æ—Ä–æ–Ω—ã.
> 
> **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–Ω–æ–≥–∏–µ Cisco IOS —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ä–µ–∂–∏–º–µ **v1.99**. –≠—Ç–æ —Ä–µ–∂–∏–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏: *"–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é v2, –Ω–æ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç v1, —è —Å–æ–≥–ª–∞—à—É—Å—å"*.
> **–£–≥—Ä–æ–∑–∞:** –ê—Ç–∞–∫–∞ "Downgrade Attack". –•–∞–∫–µ—Ä –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –Ω–∞—á–∞–ª–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Ä–æ—É—Ç–µ—Ä –æ–ø—É—Å—Ç–∏—Ç—å—Å—è –¥–æ –¥—ã—Ä—è–≤–æ–π –≤–µ—Ä—Å–∏–∏ 1.
> 
> **–ö–æ–º–∞–Ω–¥–∞:**
> ```bash
> ip ssh version 2
> ```
> * **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è v2 –∫–ª—é—á–∏ RSA –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–º–∏–Ω–∏–º—É–º 768 –±–∏—Ç**. –ï—Å–ª–∏ —É –≤–∞—Å –∫–ª—é—á–∏ 512 –±–∏—Ç, –∫–æ–º–∞–Ω–¥–∞ –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É.

> [!NOTE]- üõ°Ô∏è 2. –ó–∞—â–∏—Ç–∞ –æ—Ç –ë—Ä—É—Ç—Ñ–æ—Ä—Å–∞ (Session Hardening)
> –†–æ—É—Ç–µ—Ä—ã Cisco –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (CPU). –ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç 100 —Å–µ—Å—Å–∏–π –≤ —Å–µ–∫—É–Ω–¥—É, —Ä–æ—É—Ç–µ—Ä "–ª—è–∂–µ—Ç" (DoS), –¥–∞–∂–µ –µ—Å–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–µ –ø–æ–¥–±–µ—Ä—É—Ç.
> –ú—ã –¥–æ–ª–∂–Ω—ã —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤—Ö–æ–¥–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ "–≤—è–∑–∫–∏–º" –∏ –Ω–µ—É–¥–æ–±–Ω—ã–º –¥–ª—è –±–æ—Ç–∞.
> 
> | –ü–∞—Ä–∞–º–µ—Ç—Ä | –ö–æ–º–∞–Ω–¥–∞ | –õ–æ–≥–∏–∫–∞ –∑–∞—â–∏—Ç—ã |
> | :--- | :--- | :--- |
> | **–¢–∞–π–º-–∞—É—Ç** | `ip ssh time-out <SEC>` | **Default: 120 —Å–µ–∫.** –ë–æ—Ç –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ "–≤–∏—Å–µ—Ç—å", –∑–∞–Ω–∏–º–∞—è –ø–æ—Ä—Ç. –°–æ–∫—Ä–∞—â–∞–µ–º –¥–æ **30-60 —Å–µ–∫**. –ñ–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫ —É—Å–ø–µ–µ—Ç –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å, –±–æ—Ç ‚Äî –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω. |
> | **–ü–æ–ø—ã—Ç–∫–∏** | `ip ssh authentication-retries <NUM>` | **Default: 3.** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è. –°—Ç–∞–≤–∏–º **2**. –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–±–æ—Ä–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–Ω–æ–≤–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –¥–æ–ª–≥—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É Handshake (–æ–±–º–µ–Ω –∫–ª—é—á–∞–º–∏), —á—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç –∞—Ç–∞–∫—É –≤ —Ä–∞–∑—ã. |
> | **–õ–æ–≥–∏** | `ip ssh logging events` | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∞—É–¥–∏—Ç–∞ (SIEM). –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏: –∫—Ç–æ –ø—Ä–∏—à–µ–ª, –∫–æ–≥–¥–∞, —É—Å–ø–µ—à–Ω–æ –∏–ª–∏ –Ω–µ—Ç. |
> 
> ```bash
> ! –ü—Ä–∏–º–µ—Ä Hardening-–∫–æ–Ω—Ñ–∏–≥–∞
> ip ssh time-out 30
> ip ssh authentication-retries 2
> ip ssh logging events
> ```

> [!TIP] üß† 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Source Interface (Management Plane)
> –†–æ—É—Ç–µ—Ä Cisco ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –°–µ—Ä–≤–µ—Ä, –Ω–æ –∏ –ö–ª–∏–µ–Ω—Ç. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–π—Ç–∏ **–ù–ê** —Ä–æ—É—Ç–µ—Ä, –∞ –º–æ–∂–µ—Ç–µ –ø—Ä—ã–≥–Ω—É—Ç—å **–°** —Ä–æ—É—Ç–µ—Ä–∞ –Ω–∞ –¥—Ä—É–≥–æ–π —Å–≤–∏—Ç—á (`ssh user@10.0.0.2`).
> 
> **–ü—Ä–æ–±–ª–µ–º–∞:** –° –∫–∞–∫–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞ –ø—Ä–∏–ª–µ—Ç–∏—Ç –ø–∞–∫–µ—Ç –Ω–∞ —Å–≤–∏—Ç—á? –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Å IP –±–ª–∏–∂–∞–π—à–µ–≥–æ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –≠—Ç–æ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ (–º–∞—Ä—à—Ä—É—Ç—ã –º–µ–Ω—è—é—Ç—Å—è).
> **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–±–∏—Ç—å –∞–¥—Ä–µ—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≥–≤–æ–∑–¥—è–º–∏ –∫ Loopback-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.
> 
> ```bash
> ip ssh source-interface loopback 0
> ```
> *–¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö —Å–æ—Å–µ–¥–Ω–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤—ã –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≤–∏–¥–Ω—ã –ø–æ–¥ –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ "–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º IP".*

> [!NOTE]- üîê 4. –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ê–ª–≥–æ—Ä–∏—Ç–º–æ–≤ (Crypto Algorithms)
> **(Advanced Level)**
> –í –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö IOS (15.x –∏ –≤—ã—à–µ) –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ–º, **–ö–ê–ö –ò–ú–ï–ù–ù–û** —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –º–Ω–æ–≥–∏—Ö –≥–æ—Å. —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∏ –±–∞–Ω–∫–æ–≤.
> 
> –ö–æ–º–∞–Ω–¥–∞: `ip ssh {server | client} algorithm ...`
> 
> **–°—Ü–µ–Ω–∞—Ä–∏–π:** –û—Ç–∫–ª—é—á–∏—Ç—å —Å–ª–∞–±—ã–µ —à–∏—Ñ—Ä—ã (DES, 3DES, RC4) –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –º–æ—â–Ω—ã–π AES.
> ```bash
> ! –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ AES-256
> ip ssh server algorithm encryption aes256-ctr aes256-cbc
> ! –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–∏–ª—å–Ω—ã–µ —Ö—ç—à–∏ (SHA2)
> ip ssh server algorithm mac hmac-sha2-512 hmac-sha2-256
> ```
> *–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞—Ä—ã–π Putty) –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å 3DES, —Ä–æ—É—Ç–µ—Ä —Ä–∞–∑–æ—Ä–≤–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.*

> [!NOTE]- üîÑ 5. –ü–æ—Ä—Ç—ã –∏ Forwarding (–†–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
> SSH —É–º–µ–µ—Ç –ø—Ä–æ–∫–∏–¥—ã–≤–∞—Ç—å —Ç—É–Ω–Ω–µ–ª–∏ (Port Forwarding), –∫–∞–∫ –≤ Linux.
> 
> * **–°–º–µ–Ω–∞ –ø–æ—Ä—Ç–∞:** –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–ø—Ä—è—Ç–∞—Ç—å SSH —Å 22-–≥–æ –ø–æ—Ä—Ç–∞ –Ω–∞ –¥—Ä—É–≥–æ–π (Security by Obscurity).
>   *–í Cisco —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –Ω–µ —á–µ—Ä–µ–∑ `ip ssh`, –∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `ip port-map` –∏–ª–∏ `rotary` –Ω–∞ –ª–∏–Ω–∏—è—Ö (–æ—á–µ–Ω—å —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥, —Å–µ–π—á–∞—Å –ø–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).*
>   
> * **Port Forwarding:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —Å–∫–≤–æ–∑—å —Ä–æ—É—Ç–µ—Ä –≤–Ω—É—Ç—Ä–∏ SSH-—Ç—É–Ω–Ω–µ–ª—è.
>   `ip ssh server allow-agent-forwarding` (–æ–±—ã—á–Ω–æ –≤—ã–∫–ª—é—á–µ–Ω–æ).

---

## üîó –°–≤—è–∑–∏
* **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** [[Cs - show ip ssh]] (–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).
* **–°–º–æ—Ç—Ä–µ—Ç—å —Å–µ—Å—Å–∏–∏:** `show ssh` (–ö—Ç–æ —Å–µ–π—á–∞—Å –ø–æ–¥–∫–ª—é—á–µ–Ω).
* **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑—Ä—ã–≤:** `disconnect <ID>` (–í—ã–∫–∏–Ω—É—Ç—å —Ö–∞–∫–µ—Ä–∞/–∑–∞–≤–∏—Å—à—É—é —Å–µ—Å—Å–∏—é).
